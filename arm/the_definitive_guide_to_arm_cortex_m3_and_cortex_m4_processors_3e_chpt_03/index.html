<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple_touch_icon_next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_32x32_next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_16x16_next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.27.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/serach.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js" defer></script><link rel="canonical" href="http://example.com/arm/the_definitive_guide_to_arm_cortex_m3_and_cortex_m4_processors_3e_chpt_03/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/arm/the_definitive_guide_to_arm_cortex_m3_and_cortex_m4_processors_3e_chpt_03/","path":"arm/the_definitive_guide_to_arm_cortex_m3_and_cortex_m4_processors_3e_chpt_03/","title":"《ARM Cortex-M3与Cortex-M4权威指南 第3版》第3章 技术综述"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>《ARM Cortex-M3与Cortex-M4权威指南 第3版》第3章 技术综述 |</title><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script><script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script><script src="/js/third-party/search/local-search.js" defer></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js" defer></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title"></p><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E4%BB%A4%E9%9B%86"><span class="nav-text">3.1 指令集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E5%99%A8%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.2 存储器系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8E%E5%8A%9F%E8%80%97"><span class="nav-text">3.3 低功耗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E5%8D%95%E5%85%83"><span class="nav-text">3.4 内存保护单元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E6%96%AD%E5%A4%84%E7%90%86"><span class="nav-text">3.5 中断处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#os%E6%94%AF%E6%8C%81%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="nav-text">3.6 OS支持和系统级功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E8%AF%95%E6%94%AF%E6%8C%81"><span class="nav-text">3.7 调试支持</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name"></p><div class="site-description" itemprop="description">这只是个人学习总结，难免出错，欢迎指出，邮箱：concerto-grosso@outlook.com</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">72</span> <span class="site-state-item-name">文章</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/arm/the_definitive_guide_to_arm_cortex_m3_and_cortex_m4_processors_3e_chpt_03/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""><meta itemprop="description" content="这只是个人学习总结，难免出错，欢迎指出，邮箱：concerto-grosso@outlook.com"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="《ARM Cortex-M3与Cortex-M4权威指南 第3版》第3章 技术综述 | null"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">《ARM Cortex-M3与Cortex-M4权威指南 第3版》第3章 技术综述</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2025-05-19 00:00:00" itemprop="dateCreated datePublished" datetime="2025-05-19T00:00:00+08:00">2025-05-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-05-20 00:00:00" itemprop="dateModified" datetime="2025-05-20T00:00:00+08:00">2025-05-20</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/arm/" itemprop="url" rel="index"><span itemprop="name">ARM</span></a> </span></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.2k</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>　　所有Cortex-M处理器都是32位RISC处理器，其寄存器、内部数据路径和总线接口都是32位。</p><p>　　除了能够处理32位数据之外，Cortex-M处理器也能高效地处理8位和16位数据。Cortex-M3和Cortex-M4处理器还支持一些涉及64位数据的操作 (例如，乘法和累加)。</p><p>　　Cortex-M处理器使用了32位地址 (4GB的地址空间) 和统一内存映射，所以程序代码、数据、外设和处理器内部的部分调试支持组件共享内存空间。</p><p>　　与其他ARM处理器一样，Cortex-M处理器基于加载-存储架构，这表示数据需要从存储器中加载，然后进行处理，最后通过多个独立的指令写回到存储器。例如，增加存储在SRAM中数据的值需要3条指令。第1条指令会将数据从SRAM读取到处理器内部的寄存器，第2条指令会增加数据的值，第3条指令会将数据写回到存储器。处理器内部的寄存器细节称为<span style="background-color:#ff0">程序员模型</span>。</p><p>　　对于ARM处理器，术语架构可以指2个方面：</p><p>　　● 架构 (ISA、程序员模型和调试方法)</p><p>　　● 微架构 (接口信号、指令执行时序和流水线阶段等特定于处理器设计的细节)</p><p>　　不同ARM处理器使用的架构不尽相同。ISA可以通过各种微架构实现 (例如，不同数量的流水线阶段和不同类型的总线接口协议)。</p><p>　　Cortex-M处理器的总线接口是32位，并且基于AMBA标准 (AMBA包含一系列总线协议规范)。</p><p>　　Cortex-M3和Cortex-M4处理器使用了3阶段流水线设计 (取指阶段、译码阶段和执行阶段) 和哈佛总线架构 (可以同时取指和访问数据)。</p><span id="more"></span> <img src="/arm/the_definitive_guide_to_arm_cortex_m3_and_cortex_m4_processors_3e_chpt_03/block_diagram_of_the_cortex-m3_and_cortex-m4_processor.svg"><p>　　从宏观角度，Cortex-M3和Cortex-M4处理器极其相似。尽管内部数据路径设计存在显著差异，但处理器的某些部分 (例如，NVIC、取指缓冲区以及译码和执行阶段的某些部分) 是相似的。此外，处理器核心之外的组件几乎相同。</p><p>　　Cortex-M3和Cortex-M4处理器包含处理器核心、NVIC、SysTick定时器和可选的浮点处理单元 (FPU)。除此之外，处理器还包含内部总线系统、可选的内存保护单元和一系列用于支持软件调试操作的组件。内部总线互联用于将处理器和调试器的传输路由到设计的各个部分。</p><p>　　Cortex-M3和Cortex-M4处理器具有高度可配置性。例如，调试功能是可选的，以允许片上系统设计者在产品不需要调试支持时移除调试组件，进而减少芯片面积。在某些情况下，芯片设计者还可以选择减少硬件指令断点和数据观察点比较器的数量来减少门数。中断输入的数量、中断优先级的数量和MPU等很多功能也是可配置的。</p><p>　　Cortex-M3和Cortex-M4处理器支持多处理器设计的独占访问 (对多处理器设计中的信号量很重要)。</p><h3 id="指令集">3.1 指令集</h3><p>　　ARM7TDMI等经典处理器有2种工作状态：32位的ARM状态和16位的Thumb状态。当处于ARM状态时，指令是32位，并且核心能以非常高的性能执行指令。当处于Thumb状态时，指令是16位 (提供出色的代码密度)，但Thumb指令不具备ARM指令的所有功能，并且完成特定类型的操作需要更多指令。</p><img src="/arm/the_definitive_guide_to_arm_cortex_m3_and_cortex_m4_processors_3e_chpt_03/switching_between_arm_code_and_thumb_code_in_classic_arm_processors_such_as_arm7tdmi.svg" title="switching_between_arm_code_and_thumb_code_in_classic_arm_processors_such_as_arm7tdmi"><p>　　为了两全其美，很多经典ARM处理器的应用程序都支持ARM代码和Thumb代码的混合。但是，混合代码的设计也存在问题。在这2种状态之间切换存在开销，并且这2种状态的分离会增加软件编译过程的复杂度。</p><p>　　随着Thumb-2技术的推出，Thumb指令集扩展为同时支持16位和32位指令编码，这让不需切换状态就能完成所有处理成为可能。实际上，Cortex-M处理器完全不支持32位ARM指令 (经典ARM处理器会在处理中断时会切换到ARM状态，但Cortex-M处理器不会)。借助Thumb-2技术，Cortex-M处理器在某些方面比经典ARM处理器更具优势：</p><p>　　● 没有状态切换开销 (节省了执行时间和指令空间)。</p><p>　　● 无需在源文件中指定ARM状态或Thumb状态 (让软件开发更简单)。</p><p>　　● 同时获取最佳的代码密度、效率和性能。</p><p>　　● 相比ARM7TDMI等经典ARM处理器，Thumb-2技术大幅扩展了Thumb指令集。</p><p>　　尽管所有Cortex-M处理器支持Thumb-2技术，但它们实现的指令集只是Thumb ISA的各种子集：</p><table><colgroup><col style="width:28%"><col style="width:25%"><col style="width:11%"><col style="width:11%"><col style="width:23%"></colgroup><thead><tr><th>指令组</th><th>Cortex-M0和Cortex-M1</th><th>Cortex-M3</th><th>Cortex-M4</th><th>带有FPU的Cortex-M4</th></tr></thead><tbody><tr><td>16位ARMv6-M指令</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>带有链接的32位分支指令</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>32位系统指令</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>16位ARMv7-M指令</td><td></td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>32位ARMv7-M指令</td><td></td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>DSP扩展</td><td></td><td></td><td>✓</td><td>✓</td></tr><tr><td>浮点指令</td><td></td><td></td><td></td><td>✓</td></tr></tbody></table><p>　　Cortex-M处理器不支持Thumb ISA的部分指令 (例如，尽管添加了独立的内存映射数据处理引擎，但依然不支持协处理器指令)。此外，Cortex-M处理器也不支持部分来自经典ARM处理器的Thumb指令 (例如，会导致处理器立即从Thumb状态切换到ARM状态的带有链接和切换的分支指令、部分会导致处理状态切换的指令以及设置大端或小端的指令)。</p><h3 id="存储器系统">3.2 存储器系统</h3><p>　　Cortex-M3和Cortex-M4处理器本身没有存储器 (即没有程序存储器、SRAM和缓存)。相反，它们通常配备了通用片上总线接口，所以微控制器供应商可以添加自己的存储器系统。微控制器供应商通常会将程序存储器 (通常是闪存)、数据存储器 (通常是SRAM) 和外设添加到存储器系统。</p><p>　　通过这种方式，不同的微控制器产品可以具有不同的存储器配置、不同的存储器容量和不同的外设。</p><p>　　Cortex-M3和Cortex-M4处理器主要使用的总线接口协议是AHB Lite (用于程序存储器和系统总线接口)。AHB Lite是流水线总线协议，允许高频率操作和低硬件面积成本。此外，AHB Lite还支持插入等待状态、多个总线主机共享同一总线和总线错误条件。另一个使用的总线协议是APB (用于基于ARM的微控制器的外设系统)。此外，APB还用于Cortex-M3和Cortex-M4处理器的调试支持。</p><p>　　不同于片外总线协议，AHB Lite和APB相当简单，因为芯片内部的硬件配置是固定的，所以不需要复杂的初始化协议来控制各种可能的配置。</p><p>　　使用开放且通用的总线架构允许芯片设计者为ARM处理器开发外设、存储控制器和片上存储器模块。</p><p>　　Cortex-M3和Cortex-M4处理器还支持可选的位带功能：SRAM和外设区域中的2个位寻址区域。通过位带别名地址的位值修改会转换为对位带区域的原子读-修改-写操作。</p><p>　　虽然Cortex-M3和Cortex-M4处理器在大端和小端模式下都可以运行，但几乎所有微控制器都设计为大端或小端模式之一。大多数Cortex-M微控制器产品使用的是小端模式。</p><h3 id="低功耗">3.3 低功耗</h3><p>　　Cortex-M处理器设计为低功耗实现。很多Cortex-M3和Cortex-M4微控制器的运行电流可以低于200μA/MHz (在1.8V的供电电压下约为0.36mW/MHz)，其中的部分微控制器的运行电流甚至可以低于100μA/MHz。Cortex-M处理器包括以下低功耗特性：</p><p>　　● Cortex-M3处理器专为低成本微控制器设计，其芯片面积较小 (门数较少)。Cortex-M4处理器由于添加了SIMD指令和浮点指令而略微增加了芯片面积。3阶段流水线设计在性能和芯片面积之间达到了良好的平衡。</p><p>　　● Cortex-M处理器的高代码密度允许软件开发者以更小的程序存储器来实现其目的 (更小的程序存储器可以降低功耗)。</p><p>　　● Cortex-M处理器提供了大量低功耗功能，包括架构中定义的睡眠模式和集成的架构时钟门控支持。</p><p>　　● 完全静态、异步和可合成的设计使处理器能够使用任何低功耗和标准半导体工艺制造。从Cortex-M3的第2版开始 (以及目前所有的Cortex-M4版本)，处理器还支持额外的WIC，以进一步降低功耗。</p><p>　　除了能够延长电池寿命之外，微控制器的低功耗还有助于减少电磁干扰，并可能简化电源设计 (或减小电池尺寸)，从而降低系统成本。</p><h3 id="内存保护单元">3.4 内存保护单元</h3><p>　　MPU是Cortex-M3和Cortex-M4处理器的可选功能。微控制器供应商可以选择是否添加该功能。MPU是监控总线事务的可编程设备，并且需要通过软件 (通常是嵌入式OS) 配置。若添加了MPU，则应用程序可以将内存划分为多个区域，并定义每个区域的访问权限。当违反访问规则时，会生成故障异常。故障处理函数能够分析故障，并在可能时进行修复。</p><p>　　MPU可以以多种方式使用。通常，OS可以设置MPU来保护OS内核和其他特权任务使用的数据，防止不受信任的用户程序损坏它们。此外，OS也能在不同的任务之间隔离内存区域。这些措施可以更好地检测系统故障，并使系统在处理错误条件时更具健壮性。</p><p>　　MPU也可用于将内存区域设置为只读来防止意外擦除SRAM中的数据被或覆盖指令码。</p><p>　　在默认情况下，MPU会关闭，并且不使用该功能的应用程序不必对其进行初始化。</p><h3 id="中断处理">3.5 中断处理</h3><p>　　Cortex-M3和Cortex-M4处理器包含1个称为NVIC的中断控制器。NVIC提供了以下功能：</p><p>　　● 支持多达240个中断输入、1个NMI输入以及多个系统异常。除了NMI之外，其他中断都可以启用或关闭。</p><p>　　● 支持可编程优先级。对于Cortex-M3和Cortex-M4处理器，优先级可以在运行时动态修改 (Cortex-M0和Cortex-M0+不支持动态修改优先级)。</p><p>　　● 支持中断/异常优先级自动处理和嵌套中断/异常处理。</p><p>　　● 支持向量中断/异常，这表示处理器会自动获取中断/异常向量 (无需软件确定目标中断/异常)。</p><p>　　● 向量表可以重定位到内存的不同区域。</p><p>　　● 低中断延迟 (对于零等待状态内存系统，中断延迟仅为12个周期)。</p><p>　　● 中断和很多异常可以由软件触发。</p><p>　　● 各种优化以减少在不同异常上下文之间切换时的中断处理开销。</p><p>　　● 支持中断/异常屏蔽机制 (允许屏蔽NMI之外的所有中断和异常，或屏蔽优先级低于某个阈值的中断/异常)。</p><p>　　为了支持以上功能，NVIC有很多可编程寄存器。这些寄存器是映射到内存的，并且CMSIS-Core提供了大多数常见中断控制任务所需的寄存器定义和访问函数 (这些访问函数在Cortex-M0等其他Cortex-M处理器上也能使用)。</p><p>　　存储着中断和系统异常的起始地址的向量表是系统内存的一部分。在默认情况下，向量表位于内存空间的<span style="background-color:#ff0">起始处</span> (地址<code>0x0</code>)，但向量表偏移量可以在运行时修改。对于大多数应用程序，向量表在编译时可以设置为应用程序映像的一部分，并在运行时保持不变。</p><p>　　NVIC提供的信号的数量和支持的可编程中断优先级由微控制器供应商在设计芯片时决定。</p><h3 id="os支持和系统级功能">3.6 OS支持和系统级功能</h3><p>　　Cortex-M3和Cortex-M4处理器设计为高效地支持嵌入式OS。内置的系统节拍 (SysTick) 定时器可以设置为生成周期性定时器中断 (用于OS时间记录)。由于Cortex-M3和Cortex-M4处理器都提供了SysTick定时器，所以嵌入式OS的源码可以轻松地在这些设备上使用，而无需针对特定于设备的定时器进行修改。</p><p>　　Cortex-M3和Cortex-M4处理器有多种栈指针：用于OS内核和中断的主栈指针和用于应用程序任务的进程栈指针。通过这种方式，OS内核使用的栈可以与应用程序任务使用的栈分离。这不仅提高了可靠性，还能优化栈空间的使用。对于不需要使用OS的简单应用程序，可以直接使用主栈指针。</p><p>　　为了进一步提供系统可靠性，Cortex-M3和Cortex-M4处理器支持特权工作模式和非特权工作模式的分离。处理器默认以特权模式启动。当在OS中执行用户任务时，用户任务的执行在非特权工作模式下进行。特权工作模式和非特权工作模式的分离可以与MPU一起使用来防止非特权任务访问特定内存区域。通过这种方式，用户任务无法损坏OS内核和其他任务使用的数据。</p><p>　　Cortex-M处理器还支持多个故障处理函数。若检测到故障 (例如，访问无效内存地址)，则会触发故障异常，而故障处理函数可以作为防止系统进一步故障和诊断错误的措施。</p><h3 id="调试支持">3.7 调试支持</h3><p>　　Cortex-M3和Cortex-M4处理器的闪存补丁和断点单元支持多达8个用于断点的硬件比较器 (6个用于指令地址，2个用于字面数据地址)。当触发这些比较器时，会停止处理器或将数据传输重映射到SRAM位置。重映射功能允许修改只读的程序内存位置。</p><p>　　Cortex-M3和Cortex-M4处理器的数据观察点和跟踪单元支持多达4个硬件数据观察点比较器。这些比较器可用于在访问特定数据时停止处理器或生成可以通过跟踪接口收集的跟踪信息 (无需停止处理器)。然后，调试器可以在IDE中显示数据值和额外信息，以可视化数据随时间的变化。</p><p>　　Cortex-M3和Cortex-M4处理器还包含1个可选的嵌入式跟踪宏单元模块，该模块可以用于跟踪指令。</p><p>　　可以通过JTAG连接或串行线调试接口来调试Cortex-M3和Cortex-M4处理器。很多开发工具供应商都支持这2种协议。跟踪信息可以通过串行线查看器接口收集。若需要高跟踪带宽 (例如，使用指令跟踪)，则需要使用跟踪端口接口来收集跟踪信息。</p></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/linux/the_linux_programming_interface_a_linux_and_unix_system_programming_handbook_chpt_23/" rel="prev" title="《Linux&#x2F;UNIX系统编程手册》第23章 定时器和睡眠"><i class="fa fa-angle-left"></i> 《Linux/UNIX系统编程手册》第23章 定时器和睡眠</a></div><div class="post-nav-item"><a href="/linux/the_linux_programming_interface_a_linux_and_unix_system_programming_handbook_chpt_24/" rel="next" title="《Linux&#x2F;UNIX系统编程手册》第24章 进程创建">《Linux/UNIX系统编程手册》第24章 进程创建 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class="footer"><div class="footer-inner"></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript></body></html>